# 量子纠错

量子纠错主要讨论在存在噪声的情况下，如何可靠地进行量子信息处理。这涉及到三个主要的问题：量子纠错码的基本理论、容错量子计算和阈值定理。此综述的这一章将首先讨论量子纠错码的基本理论，它能抵抗噪声以保护量子信息。随后将阐述容错量子计算的理论， 这将允许我们去掉在基本理论部分的推导过程中的完美编码和解码假设。最后，本章的重点是量子计算的阈值定理：在单个量子门中的噪声低于一个确定阈值前提下，有可能有效地执行任意规模的量子计算。阈值定理表明噪声对大规模量子计算的性能看来并不会造成根本障碍。

# 噪声

噪声是信息处理系统的一大祸害。只要有可能，我们总要使我们构造的系统完 全避免噪声， 而对不可能的情形，我们会试图抵消噪声的影响。举例来说，现代计算机中的元部件都是非常可靠的，典型故障率低于每 $10^{17}$ 次运算出 1 次差错。对于绝大多数的实际用途，我们可以认为计算机元部件完全没有噪声。然而，许多广泛应用中的系统确实面临真正的噪声问题。调制解调器和光盘播放装置两者都采用纠错码保护信息免受噪声影响。实际中用于针对噪声的保护技术的细节有时还 是相当复杂的， 但其基本原理是容易理解的。关键的思想是，如果我们想要针对噪声的影响保护一个消息，那么我们应当通过对这个消息加入一些冗余信息来编码消息。采用这种方法，即使编码消息中的某些信息为噪声所污染，在编码消息中仍将有足够的冗余度使有可能恢复或解码消息，使得原来消息中的所有信息得以恢复。
举例来说，设我们想要通过带噪声经典信道从一个位置发送一个比特到另一个位置。信道中噪声的影响是以概率 $p>0$ 将正在被传输的比特翻转，而以概率 $1-p$ 使比特无差错地传输。这种信道称为二元对称信道 ( binary symmetric channel)，见下图。针对二元对称信道中噪声的影响来保护比特的一个简单手段是，把我们所想保护的比特替换为其自身的三份备份:
$$
\begin{aligned}
0 & \rightarrow 000 \\
1 & \rightarrow 111
\end{aligned}
$$
这个比特串 000 和 111 有时被叫做逻辑 0 和逻辑 1 ， 因为它们分别扮演了 0 和 1 的角色。我们现在通过信道发送所有这三个比特。在信道的接收方三个比 特均为输出，且接收方必须确定原来的比特的值是什么。设从信道的输出为 001。规定一个比特翻转的概率 $p$ 为不太高， 非常可能是第三比特被信道翻转，而 0 为所发送的比特。

```mermaid
flowchart LR
			A([0])
      B([1])
      C([0])
      D([1])
      B--p-->C
      B--1-P-->D
      A--P-->D
      A--1-P-->C
      
```

这种类型的解码被称为多数判决 (majority voting)，因为信道的解码输出不论是 1 还是 0 ，在实际信道输出都占多数。如果通过信道发送的比特中两个或多个被翻转那么多数判决失败， 否则多数判决成功。所有比特中两个或多个被翻转的概率为 $3 p^{2}(1-p)+p^{3}$， 所以差错的概率为 $p_{\mathrm{e}}=$ $3 p^{2}-2 p^{3}$。要是没有编码，出现一个差错的概率为 $p$， 所以只要 $p_{\mathrm{e}}<p$ 这种编码会使传输更为可靠， 而 $p<1 / 2$ 时就是这种情况。

因为我们是通过将所发送的消息重复多次而来对其编码的，所以刚才描述的这类码称为重复码 (repetition code)。类似的技术作为日常谈话的一部分已被用了 上千年：如果我们听某个人所说的话语有困难，或许是因为他们有外国口音，我们会请他们重复一下他们刚才说的是什么。我们可能在任一时间里没有听清楚所有的词， 但是我们可把重复的话合起来以理解一个连续的消息。在经典纠错码的理论中， 发展了许多聪明的技术，但是，关键的思想始终是利用足够的冗余来编码消息，使得有噪声的编码消息仍可以恢复原来的消息，至于需要添加的冗余量则依赖于信道中噪声的严重程度。

## 三量子比特的比特翻转编码

为了抵消噪声的影响保护量子状态，我们将会基于类似的原理来引入量子纠错码。经典信息和量子信息之间存在着一些重要的区别，这就需要引人一种新的思想以使这样的量子纠错码成为可能。这种新的思想需要克服如下三个问题：

1. 不可克隆：有人可能试图通过将量子状态复制三次或多次，以量子力学方式来实现重复码。但据不可克隆 (no-cloning) 定理, 这种作法是不允许的，即使复制是可能的，也不可能来度量和比较来自信道的三个量子状态输出。

2. 差错是连续的：连续的不同差错可能出现在单量子比特上。为确定哪个差错出现以便来纠正它，看来需要无穷高的精度，因此要求无穷多的计算资源。

3. 测量会破坏量子信息：在经典纠错中, 我们会观测来自信道的输出，并决定采用什么样的解码步骤。量子力学中的观测一般会破坏所观测的量子状态并使恢复成为不可能。

幸运的是，这三个问题中没有一个是致命的。假设通过一个信道发送量子比特，信道以概率 $1-p$ 保持量子比特不改变，以概率 $p$ 使量子比特翻转. 也即以概率 $p$ 状态 $|\psi\rangle$ 被取为状态 $X|\psi\rangle$, 其中 $X$ 为通常的 Pauli sigma $x$ 算子或比特翻转算子。这种信道被称为比特翻转信道(bit flip channel)，我们现在来解释比特翻转码 (bit flip code)，这种编码可被用来处理来自这种信道的噪声的影响，进而保护量子比特。
   设我们将单量子比特状态 $a|0\rangle+b|1\rangle$ 用三个量子比特编码为 $a|000\rangle+$ $b|111\rangle$。一个方便的方法是把这个编码写为
$$
\begin{aligned}
|0\rangle \rightarrow\left|0_{\mathrm{L}}\right\rangle & \equiv|000\rangle \\
|1\rangle \rightarrow\left|1_{\mathrm{L}}\right\rangle & \equiv|111\rangle
\end{aligned}
$$
其中，基状态的叠加被取为相应编码状态的叠加。符号 $\left|0_{\mathrm{L}}\right\rangle$ 和 $\left|1_{\mathrm{L}}\right\rangle$ 表示这些是逻辑 $|0\rangle$ 和逻辑 $|1\rangle$ 状态，而不是物理的 0 和 1 状态。

设初始状态 $a|0\rangle+b|1\rangle$ 已被完美地编码为 $a|000\rangle+b|111\rangle$。这三个量子比特中的每一个 都通过一个比特翻转信道的独立备份。设一个或更少的量子比特出现了一个比特翻转。有一种简单的两阶段纠错方法，可用于恢复和纠正这种情况中的量子状态。

1. 阶段一：差错检测 (error-detection) 或症状诊断 (syndrome diagnosis)：我们执行一次测量，它会告诉我们什么差错 (如果存在的话) 出现在量子状态上。这个测量结果被称为差错症状 (error syndrome)。对于比特翻转信道，对应于四个投影算子，可有四种差错症状：

$$
\begin{array}{lll}P_{0} \equiv|000\rangle\langle 000|+| 111\rangle\langle 111| & \text { 没有差错 }  \\ P_{1} \equiv|100\rangle\langle 100|+| 011\rangle\langle 011| & \text { 第一量子比特上比特翻转 }  \\ P_{2} \equiv|010\rangle\langle 010|+| 101\rangle\langle 101| & \text { 第二量子比特上比特翻转 }  \\ P_{3} \equiv|001\rangle\langle 001|+| 110\rangle\langle 110| & \text { 第三量子比特上比特翻转 }\end{array}
$$

设举例来说比特翻转出现在第一个量子比特上，所以破坏后的状态为 $a|100\rangle+$ $b|011\rangle$。注意到在这种情况中 $\left\langle\psi\left|P_{1}\right| \psi\right\rangle=1$，所以测量结果 (差错症状) 的输出肯定为 1。进而差错症状测量不会引起状态的任何改变，在差错症状测量之前和之后 的状态都为 $a|100\rangle+b|011\rangle$。注意，差错症状所包含的只是有关出现什么差错的信息，而不允许我们来推断有关 $a$ 或 $b$ 的值的任何事情，也即它不包含所被保护状态的信息。这是差错症状测量的一个普遍特征，因为为了得到有关量子状态身份的信息，一般有必要对该状态进行扰动。

2. 阶段二：恢复 (recovery)：我们采用差错症状的值来了解采用什么方法来恢复初始状态。举例来说，如果差错症状为 1，指示第一个量子比特上比特翻转，则我们只要再一次翻转那个量子比特，就以完全准确地恢复到原状态 $a|000\rangle+b|111\rangle$。这四种可能的差错状态和每种情况中的恢复方法为:

| 差错状态                  | 恢复方法               |
| ------------------------- | ---------------------- |
| 0 (没有差错)              | 什么也不用做           |
| 1(第一量子比特上比特翻转) | 再一次翻转第一量子比特 |
| 2(第二量子比 上比特翻转)  | 再一次翻转第二量子比特 |
| 3(第三量子比特上比特翻转) | 再一次翻转第三量子比特 |

对于差错症状的每个值，在给定相应所出现的差错后，容易看出原状态可得以完全准确的恢复。这种纠错方法，只要在三个量子比特出现不超过一个的比特翻转，就可完美地来工作. 这种情况以概率 $(1-p)^{3}+3 p(1-p)^{2}=1-3 p^{2}+2 p^{3}$ 出现，剩下一个差错没有纠正的概率因而为 $3 p^{2}-2 p^{3}$，正好如经典重复码。同样，对 $p<1 / 2$，编码和解码会改善量子状态的存储可靠性。
## 改善差错分析

上述这种差错分析并不是完全足够的。因为并非所有的差错和量子力学中的状态都是同等地作用的：量子状态位于连续空间中, 所以有可能某些差错只会使状态造成轻微破坏，而其他差错则使状态完全弄乱。比特翻转差错 $X$ 是一个极端的例子，这个差错根本不影响状态 $(|0\rangle+|1\rangle) / \sqrt{2}$，但会翻转 $|0\rangle$ 状态而使其变为 $|1\rangle$。在前一种情况中我们无需担心比特翻转差错的出现，而在后一种情况中我们显然会非常担心。

为讨论这个问题，我们要用到引入于保真度概念：一个纯态和一个混合态之间的保真度为 $F(|\psi\rangle, \rho)=\sqrt{\langle\psi|\rho| \psi\rangle}$。量子纠错的目标是来提高保真度，使以相当接近于最大可能保真度 1 来存储 (或传送)量子信息。让我们对利用三量子比特比特翻转码所能达到的最小保真度和当不执行纠错时的保真度来作一比较。设所感兴趣的量子状态为 $|\psi\rangle$，没有采用纠错码时，量子比特在经由信道发送后的状态为：
$$
\rho=(1-p)|\psi\rangle\langle\psi|+p X| \psi\rangle\langle\psi| X
$$
保真度为：
$$
F=\sqrt{\langle\psi|\rho| \psi\rangle}=\sqrt{(1-p)+p\langle\psi|X| \psi\rangle\langle\psi|X| \psi\rangle}
$$
平方根号中的第二项为非负且当 $|\psi\rangle=|0\rangle$ 时等于 0，所以我们看到最小保真度为 $F=\sqrt{(1-p)}$。设三量子比特纠错码被用来保护 $|\psi\rangle=a\left|0_{\text {L. }}\right\rangle+b\left|1_{\text {L. }}\right\rangle$，噪声和纠错两 者作用后的量子状态为：
$$
\rho=\left[(1-p)^{3}+3 p(1-p)^{2}\right]|\psi\rangle\langle\psi|+\cdots
$$
省略号表示的项代表两个或三个量子比特上比特翻转的贡献。所有这些省略项都是半正定算子，所以我们所计算的保真度将是真正保真度的一个下界。而另一方面，$F=\sqrt{\langle\psi|\rho| \psi\rangle} \geqslant \sqrt{(1-p)^{3}+3 p(1-p)^{2}}$。也即保真度至少为 $\sqrt{1-3 p^{2}+2 p^{3}}$，所以 存储量子状态的保真度在规定 $p<1 / 2$ 下会被改善，这与我们早先非常粗糙的分析得到的结论是相同的。

存在另一种理解差错症状测量的不同方法，它在推广三量子比特码中是会有用处的。假设，代替测量四个投影算子 $P_{0}, P_{1}, P_{2}, P_{3}$，我们来执行两个测，第一个是对可观测量 $Z_{1} Z_{2}$ (也即 $\left.Z \otimes Z \otimes I\right)$ 的，第二个是对可观测量 $Z_{2} Z_{3}$ 的。这些观测量中的每一个都具有特征值 1 ，所以每个测量都提供一个单量子比特信息，总共两个量子比特信息，即四个可能的差错症状，恰好等同于早先描述中的结果。第一个测量即对 $Z_{1} Z_{2}$ 的测量，可被想象为来比较第一个量子比特和第二个量子比特，看它们是否相同。具体而言，考虑到 $Z_{1} Z_{2}$ 具有谱分解：
$$
Z_{1} Z_{2}=(|00\rangle\langle 00|+| 11\rangle\langle 11|) \otimes I-(|01\rangle\langle 01|+| 10\rangle\langle 10|) \otimes I
$$
它对应于具有投影算子 $(|00\rangle\langle 00|+| 11\rangle\langle 11|) \otimes I$ 和 $(|01\rangle\langle 01|+| 10\rangle\langle 10|) \otimes I$ 的一个投影测量。因此，测量 $Z_{1} Z_{2}$ 可被想象为来比较第一个量子比特和第二个量 子比特的值，若它们相同给出 $+1$，若它们不同给出 $-1$。类似地，测量 $Z_{2} Z_{3}$ 被想象为比较第二个量子比特和第三个量子比特的值，若它们相同给出 $+1$，若它们不同给出 $-1$。组合这两个测量结果，我们就能确定是否有比特翻转出现在量子比特中的一个比特上，如果有那么还可来确定是哪一种：若两者测量结果都给出 $+1$，则以高概率没有比特翻转出现；若测量 $Z_{1} Z_{2}$ 给出 $+1$ 而测量 $Z_{2} Z_{3}$ 给出 $-1$，则以高概率只有第三个量子比特翻转；若测量 $Z_{1} Z_{2}$ 给出 $-1$ 而测量 $Z_{2} Z_{3}$ 给出 $+1$，则以高概率只有第一个量子比特翻转；最后，若两者测量结果都给出 $-1$，则以高概率只有第二个量子比特翻转。这些测量成功的关键是，两个测量都不会给出有关编码后量子状态的幅值 $a$ 和 $b$ 的任何信息，因而两个测量都不会破坏我们用此编码来保护的量子状态的叠加。

## 三量子比特的相位翻转码

比特翻转码是令人感兴趣的，但它看来并不是超越经典纠错码的一种重要革新，并且留下许多末解决的问题。一个更有兴趣的带噪声量子信道是单量子比特的相位翻转差错模型，在这种差错模型中，量子比特以概率 $1-p$ 得以保留，而状态 $|0\rangle$ 和 $|1\rangle$ 的相对相位以概率 $p$ 被翻转。更确切地说，相位翻转算子 $Z$ 以概率 $p>0$ 作用于量子比特，所以在相位翻转下状态 $a|0\rangle+b|1\rangle$ 变为状态 $a|0\rangle-b|1\rangle$。相位翻转信道没有经典的等价物，因为经典信道不具有任何相位的等价性质。不过，有一种简单的方法把相位翻转信道转化为比特翻转信道：

 设我们考虑的是量子比特基 $|+\rangle \equiv$ $(|0\rangle+|1\rangle) / \sqrt{2}$ 和 $|-\rangle \equiv(|0\rangle-|1\rangle) / \sqrt{2}$。关于这个基，算子 $Z$ 变 $|+\rangle$ 为 $|-\rangle$ 。并且反之亦然，也即标志 + 和 - 只是起到像比特翻转的作用。这就提示我们，采用状态 $\left|0_{\text {1. }}\right\rangle \equiv|+++\rangle$ 和 $\left|1_{\mathrm{L}}\right\rangle \equiv|---\rangle$ 作为逻辑 0 状态和逻辑 1 状态来保护针对相位翻转的差错。纠错需要的所有运算一一编码、差错检测和恢复一一都是像比特翻转信道那样来执行，只是要以 $|+\rangle,|-\rangle$ 基代替 $|0\rangle,|1\rangle$ 基。为了实现这种基的转 换，我们只要在纠错过程的适当位置上应用 Hadamard 门及其逆 (也为 Hadamard 门），因为 Hadamard 门可来实现 $|0\rangle,|1\rangle$ 基和 $|+\rangle,|一\rangle$ 基之间来回的转换。

更明确地，对相位翻转信道的编码可按两步来执行：第一，完全准确地对三个量子比特按比特翻转信道那样编码：第二，对每个量子比特作用 Hadamard 门。差错检测可通过如前相同的投影测量而来达到，但要由 Hadamard 门取共轭：$P_{j} \rightarrow P_{j}^{\prime} \equiv H^{\otimes 3} P_{j} H^{\otimes 3}$。等价地，差错症状测量可以通过测量观测量 $H^{\otimes 3} Z_{1} Z_{2} H^{\otimes 3}=X_{1} X_{2}$ 和 $H^{\otimes 3} Z_{2} Z_{3} H^{\otimes 3}=X_{2} X_{3}$ 来执行。令人感兴趣的是，按照比特翻转码的 $Z_{1} Z_{2}$ 和 $Z_{2} Z_{3}$ 的测量相类似思路，可对这些测量作出解释。对观测量 $X_{1} X_{2}$ 和 $X_{2} X_{3}$ 的测量，分别对应于比较第一和第二量子比特，以及比较第二和第三量子比特的正负号。其含义为在 $X_{1} X_{2}$ 的测量例如对形如 $|+\rangle \mid+>\otimes(\cdot)$ 或 $|-\rangle|-\rangle \otimes(\cdot)$ 的状态给出 $+1$，而对形如 $|+\rangle|-\rangle \otimes(\cdot)$ 或 $|-\rangle|+\rangle \otimes(\cdot)$ 的状态给出 $-1$。最后，纠错可用恢复运算来完成，这种运算就是从比特翻转码导出的 Hadamard 共轭(Hadamard-conjugated)恢复运算。举例来说，设我们在第一量子比特的符号中检测到一个从 $\mid+>$ 到 $\mid ->$ 的翻转，那么，我们就可通过对第一量子比特作用 $H X_{1} H=Z_{1}$ 而来恢复。对其他的差错症状可应用类似的方法。

显然，这种相位翻转信道的码具有像比特翻转信道的码相同的特性。特别是相位翻转码 的最小保真度等同于比特翻转码的最小保真度。同时，这两个信道是西等价的，因为存在一个西算子 $U$ (这种情况中的 Hadamard 门)，在第一个信道先用 $U$ 而跟随的通道用 $U^{+}$情况下，使得一个信道的作用同于另 一个信道的作用，这些运算可以平凡地合并到编码和纠错运算中。

# Shor 码

TODO: 将 hsh 学长的 Shor 码放进来。

# 量子纠错的理论

这一章将来介绍研究量子纠错的总的框架，包括量子纠错条件，这是一组使量子纠错成为可能所必须满足的方程。当然，提出这一个框架并不能保证好的量子纠错码一定存在，但是，这个框架确实可以提供背景知识，能使我们来找到好的量子纠错码。

量子纠错理论的基本思想自然地推广了由 Shor 码引发的思想，量子状态通过 酉运算被编码为量子纠错码，其形式定义为某个较大 Hilbert 空间中的一个子空 间 $C$。为方便起见，我们采用符号 $P$ 表示到码空间 $C$ 上的投影算子；且对三量子比特比特翻转码，$P=|000\rangle\langle 000|+| 111\rangle\langle 111|$。在编码以后，这个码会受到噪声的影响，紧接着执行差错症状测量以检测所出现的差错类型。一旦差错症状确定，恢复运算就会执行，以使量子系统回到这个码的原来状态。

不同的差错症状对应于整个 Hilbert 空间中保形的和正交的子空间，这些子空间必是正交的，否则它们就不能被差错症状测量可靠地区分。进而，由于到不同子空间的差错映射必将 正交码字映射到正交状态，因此这些不同的子空间必为原来码空间的保形版本，这样就能使其从差错中恢复。这个直观的图像基本上就是下面所要讨论的量子纠错条件的要旨。

为发展量子纠错的一般理论，就关于噪声的本质和关于用于处理纠错的程序，作一些尽可能少的假设，这对研究者来说是适宜的。也即，我们没有必要假定纠错是通过检测-恢复两阶段方法来做到的，也无需对量子系统的噪声作任何假定。

我们仅只作两个很宽泛的假定：噪声由量子运算 $\varepsilon$ 所描述，整个纠错方法由我们称之为纠错运算的一个保迹量子运算 $\mathscr{R}$ 承担。这个纠错运算把我们上面称为差错检测和恢复的两个步骤合并，为确保纠错是成功的，我们要求对任何状态 $\rho$，其支集位于码空间 $C$ 中，有
$$
(\mathscr{R} \circ \varepsilon)(\rho) \propto \rho
$$


量子纠错条件是一个简单方程组，它们可被检验以确定量子纠错码是否能对 抗特殊类型的噪声 $\varepsilon$。我们将应用这些条件来构造大量的量子码，并将研究量子纠 错码的一些普遍性质。

## 量子纠错条件

令 $C$ 为一个量子码，令 $P$ 为到 $C$ 的投影算子。设 $\varepsilon$ 为具有运算元 $\left\{E_{i}\right\}$ 的量子运算。则纠正 $C$ 上 $\varepsilon$ 的纠错运算 $R$ 存在的充分必要条件为，对某个复数 Hermite 矩阵 $\alpha$ 成立
$$
P E_{i}^{\dagger} E_{j} P=\alpha_{i j} P
$$
我们称运算元 $\left\{E_{i}\right\}$ 为噪声 $\varepsilon$ 的差错，且如果这样一个 $\Re$ 存在，我们就说 $\left\{E_{i}\right\}$ 组成一个可纠正的差错集合。
## 差错离散化

 我们已经讨论了针对一种特定橾声过程的量子信息的保护。但是，一般来说，我们并不准确知道量子系统遭受的是什么噪声。如果特定码 $C$ 和纠错运算 $\mathscr{R}$ 能被用于针对全部类型噪声过程的保护，那么这将会非常有用。幸运的是，量子纠错条件很容易用于严格地提供这类保护。

定理：设 $C$ 为量子码，$\mathscr{R}$ 为符合量子纠错条件的纠错运算，用以从具有算子元 $\left\{E_{i}\right\}$ 的噪声过程中恢复。设 $\mathscr{F}$ 为具有运算元 $\left\{F_{j}\right\}$ 的量子运算，运算元 $\left\{F_{j}\right\}$ 为 $E_{i}$ 的线性组合，即对某个复数矩阵 $m_{j i}$ 有 $F_{j}=\sum_{i} m_{j i} E_{i}$。那么，纠错运算 $\mathscr{R}$ 也可对码 $C$ 上的噪声过程 $\mathscr{F}$ 的作用来进行纠正。

由此，一噪声过程 $\varepsilon$，其运算元由这些差错算子 $\left\{E_{i}\right\}$ 的线性组合而成，都将通过恢复运算 $\mathscr{R}$ 可被纠正。

按此观点，设 $\varepsilon$ 为作用于单量子比特上的量子运算。那么，其每个运算元 $\left\{E_{i}\right\}$ 都可以被写成为 Pauli 矩阵 $\sigma_{0}, \sigma_{1}, \sigma_{2}, \sigma_{3}$ 的线性组合。因此，为检验 Shor 码能对第一量子比特上的单量子比特差错进行纠错，只需验证满足方程
$$
P \sigma_{i}^{1} \sigma_{j}^{1} P=\alpha_{i j} P
$$
其中 $\sigma_{i}^{1}$ 为作用于第一量子比特上的 Pauli 矩阵 $(I, X, Y$ 和 $Z)$。 一旦满足这点，就会保证第一量子比特上的任何差错过程都可以被纠正 。

概括起来，通过上例，我们已经认识到，有可能使量子差错离散化；为对抗单量子比特上可能的连续差错，只要贏得对有限差错集即四个 Pauli 矩阵的成功纠错即可。类似结果对于高维量子系统同样成立，这反映了与经典模拟系统的纠错理论的显著差异。这类系统中的纠错是非常不同的，因为原理上存在有无穷数目的不同差错症状，经典信息处理的数字纠错要成功得多，因为它只包含有限数目的差错症状。相比于与经典模拟纠错，量子纠错看起来与经典数字纠错类似得多。

## 独立差错模型

这一节中将利用不同量子比特上差错独立的假设以解释如何同时确保量子纠错理论和可靠量子信息处理。直观上，如果噪声过程独立地作用于码中的不同量 子比特上，那么在规定噪声足够弱的情况下，与非编码状态相比，纠错应当更能改善编码状态的存储保真度。为说明这一点，我们以退极化信道的例子作为开始，它会为基本思想提供一个特别简单的实证，随后再扩展这种思想来包括其他 的重要信道。

退极化信道可以由一个单参数即概率 $p$ 来描述。单量子比特上退极化信道的作用可由方程 $\varepsilon(\rho)=(1-p) \rho+(p / 3)[X \rho X+Y \rho Y+Z \rho Z]$ 来定义，并可以被解释如下概念——量子比特什么都没有发生的概率为 $1-p$，算子 $X, Y$ 和 $Z$ 中的每一个作用于量子比特的概率为 $p / 3$。退极化信道特别易于在量子纠错的背景下进行分析，因为它具有根据四个基本差错 $I, X, Y$ 和 $Z$ 来表述的一个方便的解释，而这些基本差错已被最为广泛地应用于量子码的分析中。我们将会来解释这种分析是如何进行的，然后再回到如下问题：当我们考虑一个没有由 $I, X, Y$ 和 $Z$ 运算 简单解释的过程时，情况会怎样。简单的计算显示，对通过退极化信道发送的状态，最小保真度给出为 $F=\sqrt{1-2 p / 3}=1-p / 3+O\left(p^{2}\right)$。

设我们用能纠正任何单量子比特上差错的一个 $n$ 量子比特量子码来对一个单 量子比特信息编码。设具有参数 $p$ 的退极化信道独立地作用于这个量子比特中的 每一个，则在所有 $n$ 个量子比特上所引起的联合作用为：
$$
\varepsilon^{\otimes n}(\rho)=(1-p)^{n} \rho+\sum_{j=1}^{n} \sum_{k=1}^{3}(1-p)^{n-1} \frac{p}{3} \sigma_{k}^{j} \rho \sigma_{k}^{j}+\cdots
$$
其中$\cdots$表示均为正且在分析时将丢弃的高阶项。纠错执行以后,只要 $\rho$ 原来处于码中,出现在这个和式中的所有项将会被回复到状态 $\rho$ :
$$
\left(\mathscr{R} \otimes \varepsilon^{\otimes n}\right)(\rho)=\left[(1-p)^{n}+n(1-p)^{n-1} p\right] \rho+\cdots
$$
所以保真度满足：
$$
F \geqslant \sqrt{(1-p)^{n-1}(1-p+n p)}=1-\frac{\left(\begin{array}{l}
n \\
2
\end{array}\right)}{2} p^{2}+O\left(p^{3}\right) \quad(10.45)
$$
因此在规定差错的概率 $p$ 为充分小后，采用量子纠错码会改善被这个码所保护的量子状态保真度。

并非所有噪声污染的信道都可如此容易地解释为由无差错、比特翻转、相位翻 转及其两两组合的一个随机组合。许多自然出现的量子信道都不具备这样的解释。

用 $E_{j, k}$ 表示 $E_{j}$ 在第 $j$ 个量子比特上的作用，则噪声在编码后量子比特上的影 响可写为：
$$
\begin{aligned}
\varepsilon^{\otimes n}(\rho)=&\left(E_{0,1} \otimes E_{0.2} \otimes \cdots \otimes E_{0 . n}\right) \rho\left(E_{0.1}^{\dagger} \otimes E_{0,2}^{\dagger} \otimes \cdots \otimes E_{0 . n}^{\dagger}\right)+\\
& \sum_{j=1}^{n}\left[E_{1 . j} \otimes\left(\otimes_{k \neq j} E_{0, k}\right)\right] \rho\left[E_{1 . j}^{\dagger} \otimes\left(\otimes_{k \neq j}^{\dagger} E_{0 . k}^{\dagger}\right)\right]+O\left(\gamma^{2}\right) \quad(10.47)
\end{aligned}
$$
设 $E_{0}=(1-\gamma / 4) I+\gamma Z / 4+O\left(\gamma^{2}\right)$ 和 $E_{1}=\sqrt{\gamma}(X+\mathrm{i} Y) / 2$，将这些表达式带入上式就给出：
$$
\begin{aligned}
\varepsilon^{\otimes n}(\rho)=&\left(1-\frac{\gamma}{4}\right)^{2 n} \rho+\frac{\gamma}{4}\left(1-\frac{\gamma}{4}\right)^{2 n-1} \sum_{j=1}^{n}\left(Z_{j} \rho+\rho Z_{j}\right)+\\
& \frac{\gamma}{4}\left(1-\frac{\gamma}{4}\right)^{2 n-2} \sum_{j=1}^{n}\left(X_{j}+\mathrm{i} Y_{j}\right) \rho\left(X_{j}-\mathrm{i} Y_{j}\right)+O\left(\gamma^{2}\right) \quad \text { (10.48) }
\end{aligned}
$$
设 $\rho$ 为这个码的状态。显然，$\rho$ 上的纠错作用是保持其不变。容易通过考虑在 $Z_{j}|\psi\rangle\langle\psi|$ 上的作用而来理解像在 $Z_{j} \rho$ 和 $\rho Z_{j}$ 项上的纠错作用，其中 $|\psi\rangle$ 为这个码的状态。我们设这个码使差错 $Z_{j}$ 把 $|\psi\rangle$ 变到正交于码的一个子空间，以便当执行差错症状测量时像 $Z_{j}|\psi\rangle\langle\psi|$ 那样项就不出现 (注意，即使不引入这个正交性假定，通过研究将这个码变到正交子空间上的差错算子，类似的分析仍然可以进行)。 因此，像 $Z_{j} \rho$ 那样的项在纠错以后会消失，像 $Z_{j} \rho, X_{j} \rho Y_{j}$ 和 $Y_{j} \rho X_{j}$ 那样的项也是如此。进而，纠错会将 $X_{j} \rho Y_{j}$ 和 $Y_{j} \rho X_{j}$ 变回到 $\rho$，因为这个码能纠正一个量子比特上的差错。因而，在纠错以后系统的状态为：
$$
\left(1-\frac{\gamma}{4}\right)^{2 n} \rho+2 n \frac{\gamma}{4}\left(1-\frac{\gamma}{4}\right)^{2 n-2} \rho+O\left(\gamma^{2}\right)=\rho+O\left(\gamma^{2}\right) \quad \text { (10.49) }
$$
因此，准确到阶 $\gamma^{2}$，纠错会使量子系统返回到它的原始状态 $\rho$，而对弱噪声 (小 $\left.\gamma\right)$，如同退极化信道那样，纠错会对差错产生净抑制。此处分析是针对幅值阻尼噪声模型的，但不难推广这个讨论到其他噪声模型并得到类似的结论。因此，一般情况下，本章的剩下部分，主要是针对那些特定噪声模型进行讨论。这些噪声模型可被理解为对应于 Pauli 矩阵差错的随机应用，这些应用类似于退极化信道，这样允许我们采用经典概率论中所熟悉的概念来进行分析。

## 简并编码

量子纠错码在许多方面十分类似于经典码一一首先通过测量差错症状来识别 差错，然后再进行适当地纠正。但是，有一类称为简并编码 (degenerate code) 的量子码具有经典码中不曾有的一个引人注目的性质——其思想最容易通过 Shor 码例子来说明。

考虑差错 $Z_{1}$ 和 $Z_{2}$ 在 Shor 码的码字上的影响，如同我们已经表明的，这些差错的影响在两个码字上是相同的。对经典纠错码，不同比特上的差错会导致不同的掺杂讹误的码字。简并量子码的现象是好坏参半的量子码类。坏的方面是指经典上用于证明纠错界的某些证明技术会失效，因为它们不能被应用于简并编码。 好的方面则指简并量子码看来位于最令人感兴趣的量子码之列。在某种意义下，简并量子码比之经典码能够“把更多信息封装起来”，因为不同的差错并不必然把码空间映到正交空间，并有可能 (尽管还没有被证明)，这种附加的能力会导致简并编码比之任何非简并编码能更有效地来存储量子信息。

## 量子 Hamming 界

在应用中，我们会愿意采用可能的“最好”量子码。但在给定的情形中，“最好”的意思是依赖于应用的。由于这个原因，我们希望有判据来判断一种具有特定特性的码是否存在。在本节中，我们来介绍量子 Hamming 界。这个简单界提供了关于量子码一般特性的一些灵感。不幸的是，Hamming 界适用于非简并编码，但它告诉我们更一般的界可能的样子。设想以能纠正 $t$ 或更少数目的量子比特上差错的方 式, 一个非简并编码将 $k$ 量子比特编码为 $n$ 量子比特。设出现 $j$ 个差错，其中 $j \leqslant t$。总共有 $\left(\begin{array}{l}n \\ j\end{array}\right)$ 组差错的可能出现位置。对应每组这样的位置，会有三个可能的差错——三个 Pauli矩阵 $X, Y, Z$——它们可能出现在每个量子比特中，总共有 $3^{j}$ 个可能的差错。在 $t$ 或更少量子比特上出现差错的总个数因而为：
$$
\sum_{j=0}^{t}\left(\begin{array}{l}
n \\
j
\end{array}\right) 3^{j}
$$
注意，$j=0$ 对应于“差错” $I$，即任何量子比特上没有差错的情况。为了以非简并编码方式来编码 $k$ 个量子比特，这些差错中的每个都必须对应于一个正交的 $2^{k}$ 维子空间。所有这些子空间必须置于对 $n$ 个量子比特可利用的整个 $2^{n}$ 维空间中，从而导致不等式：
$$
\sum_{j=0}^{t}\left(\begin{array}{l}
n \\
j
\end{array}\right) 3^{j} 2^{k} \leqslant 2^{n}
$$
这就是量子 Hamming 界。举例来说，考虑这样一种情形，其中我们希望以一个量子比特上差错可被容忍的方式，用 $n$ 个量子比特来编码一个量子比特。在这种情况中，量子 Hamming 界为：
$$
2(1+3 n) \leqslant 2^{n}
$$
变换后表明，这个不等式对 $n \leqslant 4$ 不满足，而对 $n \geqslant 5$ 的值满足。因此，不存在用少于 5 个量子比特对一个量子比特编码的一种非简并编码，这种编码方式能够对抗单量子比特上所有可能差错。当然，并非所有量子码都是非简并的。所以，量子 Hamming 界主要作为一种经验来使用，而不是作为量子码存在性的确实的和快速的界。

# 量子码的构建

之前的讨论对研究量子纠错码有了一个理论框架，但是还没有具体为这些纠错码提供实例。接下里的讨论将对经典线性码理论所作简短回顾，随后利用经典线性码的思想来构造一大类称为 Calderbank-Shor-Steane(CSS) 码的量子码。最后还会讨论稳定子码 （stabilizer code）来结束本章内容，这是一类比 CSS 码更为一般的码，它为构造各种不同类型的量子码提供强有力的手段。

## 经典量子码

经典纠错码有着许多各种各样的重要技术应用，所以毫不奇怪对这种码已发展出一套强有力的理论。我们在经典纠错码的技术方面的兴趣在于这些技术中的 许多对量子纠错都具有重要的意义，特别是经典线性码理论，可以用于发展很多种好的量子纠错码。本节将简短回顾经典量子码的一些理论，特别强调对量子纠错来说非常重要的思想。

编码 $k$ 个量子比特信息到 $n$ 个比特码空间的一个线性码 $C$，可由一个 $n \times k$ 生成矩阵 $G$ 来指定，$G$ 的所有元属于 $\boldsymbol{Z}_{2}$ 即 0 和 1。矩阵 $G$ 将信息映射到其编好的码。因此，$k$ 个比特消息 $x$ 被编码为 $G x$，其中消息 $x$ 被显式地当成为一个列向量。幸运的是，乘法运算以及本节中的所有其他算术运算都是按模 2 来做的。一个简单的例子是，将单量子比特映射到三个重复比特的重复码可由如下生成矩阵来给定：
$$
G=\left[\begin{array}{l}
1 \\
1 \\
1
\end{array}\right]
$$
因为 $G$ 映射可能的消息 0 和 1 到其编码后的形式 $G[0]=(0,0,0)$ 和 $G[1]=(1,1$, 1)。用 $n$ 个比特编码 $k$ 个比特信息的码为一个 $[n, k]$ 码；因而这个例子就是一个 $[3,1]$ 码。

稍微复杂一些的例子是：用每个比特的三次重复来编码两个比特一个 $[6,2]$ 码。这个例子具有生成矩阵：
$$
G=\left[\begin{array}{ll}
1 & 0 \\
1 & 0 \\
1 & 0 \\
0 & 1 \\
0 & 1 \\
0 & 1
\end{array}\right]
$$
由此，我们看到
$$
\begin{array}{lll}
G(0,0)=(0,0,0,0,0,0), & G(0,1)=(0,0,0,1,1,1) & \text { (10.55) } \\
G(1,0)=(1,1,1,0,0,0), & G(1,1)=(1,1,1,1,1,1) & (10.56)
\end{array}
$$
这恰好就是我们所期望的。这个码的可能码字的集合对应于由 $G$ 的列所张成的向量空间。所以为使所有消息都可被唯一地编码，我们要求 $G$ 的列为线性无关，除此之外其他方面对 $G$ 没有限制。

线性码比之一般纠错码的一大优点是它们的紧凑表示。一个用 $n$ 个比特编码 $k$ 个比特的一般码要求 $2^{k}$ 个长度均为 $n$ 的码字来指定编码，总共要 $n\times 2^{k}$ 个比特来指定这个码的描述.对于线性码,我们只需要指定生成矩阵的 $k n$ 个比特。这在所要求的存储量上是一个指数的节省。这种紧凑的描述反映在进行有效的编码和解码的能力上，这是经典线性码与其量子对应物稳定子码所共有的重要特性。我们已可看到，如何来执行一个经典线性码的有效编码：简单地用 $n \times k$ 生成矩阵 $G$ 乘以 $k$ 比特消息来得到 $n$ 比特编码后的消息，这是一种用 $O(n k)$ 步运算能够完成的方法。

线性码的生成矩阵定义的有吸引力的特性之一是在我们想要编码的消息和它们如何被编码之间有一种明显的关系，但执行纠错不是很清楚。按线性码的另一 种替代 (但等价) 的奇偶检验矩阵形式，线性码的纠错最容易理解。在这个定义中， 一个 $[n, k]$ 码定义为由 $\boldsymbol{Z}_{2}$ 上使 $H x=0$ 成立的所有 $n$ 元向量 $x$ 来组成，其中 $H$ 称为奇偶检验矩阵 (parity check matrix) 的一个 $(n-k) \times n$ 矩阵，其元均为 0 和 1。等价而更为简洁地，这个码可被定义为 $H$ 的核。一个编码 $k$ 比特的码具有 $2^{k}$ 个可能的码字，所以 $H$ 的核必是 $k$ 维的，因此我们要求 $H$ 为行线性无关。

为了将线性码的奇偶检验描述与生成矩阵描述联系起来，我们需要来研究一 种方法，以使我们能在奇偶检验矩阵 $H$ 和生成矩阵 $G$ 之间进行双向转换。为从奇 偶检验矩阵转换到生成矩阵，挑选 $k$ 个线性无关的向量 $y_{1}, \cdots, y_{k}$ 来张成 $H$ 的核， 并使 $G$ 具有列 $y_{1}$ 直到 $y_{k}$，为从生成矩阵去到奇偶检验矩阵，挑选 $n-k$ 个正交于 $G$ 各列的线性无关的向量 $y_{1}, \cdots, y_{n-k}$，并使 $H$ 的行为 $y_{1}^{\mathrm{T}}, \cdots, y_{n-k}^{\mathrm{T}}$ (这里正交指模 2 内积必须为 0$)$。作为一个例子，考虑由生成矩阵式$G=\left[\begin{array}{l}
1 \\
1 \\
1
\end{array}\right]$定义的 $[3,1]$ 重复码.为构造 $H$,我们挑选 3-1=2 个正交于 $G$ 各列的线性无关向量,比如说 $(1,1,0)$ 和 $(0,1,1)$。并定义奇偶检验矩阵为：
$$
H \equiv\left[\begin{array}{lll}
1 & 1 & 0 \\
0 & 1 & 1
\end{array}\right]
$$
容易检验，$H x=0$ 仅对码字 $x=(0,0,0)$ 和 $x=(1,1,1)$ 成立。

奇偶检验矩阵使差错检测和恢复变得十分明显。设我们编码消息 $x$ 为 $y=$ $G x$，但由噪声引起的一个差错 $e$ 使 $y$ 受到污染，并给出污染后的码字 $y^{\prime}=y+e($ 注 意，“+”号在这里表示比特方式的模 2 加)。因为对所有码字 $H y=0$，由此导出 $H y^{\prime}=H e$。我们称 $H y^{\prime}$ 为差错症状，它扮演类似于量子纠错中差错症状所扮演的 角色；它是污染后状态 $y^{\prime}$ 的函数 $H_{y^{\prime}}$ 如同量子差错症状是通过测量污染后量子状态所决定的。由于关系 $H y^{\prime}=H e$，差错症状包含有关出现的差错的信息，将能像 所希望那样来恢复到原来的码字 $y$。为看清这如何会是可能的，设没有差错或仅有 一个差错出现。那么，差错症状 $H y^{\prime}$ 在没有差错的情况中等于 0，而当一个差错出现在第 $j$ 个比特上时等于 $H e_{j}$，其中 $e_{j}$ 是第 $j$ 个元为 1 的单位向量。如果我们假定差错最多出现在一个比特上，那么有可能通过计算差错症状 $H y^{\prime}$ 并将其与不同的 $H e_{j}$ 值比较，以确定哪个比特需要被纠正，而来执行纠错。

更为一般地，要深人了解纠错是如何利用线性码可被执行的，这可以通过距离的概念而获知。设 $x$ 和 $y$ 各为 $n$ 比特的字。$x$ 和 $y$ 之间的 (Hamming) 距离 $d(x, y$ ) 定义为 $x$ 和 $y$ 有差异的位置的数目。举例来说，$d((1,1,0,0),(0,1,0,1))=2$。字 $x$ 的(Hamming)权重定义为全零字串到其的距离 $\mathrm{wt}(x) \equiv d(x, 0)$，也即 $x$ 中非零位置的数目。注意，$d(x, y)=\mathrm{wt}(x+y)$。为理解与纠错的联系，设我们采用一种线性纠错码，对 $x$ 编码为 $y=G x$。经噪声污染后输出 $y^{\prime}=y+e$。设一个量子比特翻转的概率小于 $1 / 2$，已编码的最可能码字为 $y$，这个码字 $y$ 得到 $y^{\prime}$ 所需要的比特翻转数目最少，即使 $\operatorname{wt}(e)=d\left(y, y^{\prime}\right)$ 取极小。原则上，应用线性码的纠错，可通过简单地以这样一个 $y$ 替换 $y^{\prime}$ 来实现。实际上，这种做法是相当没有效率的，因为确定最小距离 $d\left(y, y^{\prime}\right)$ 一般来说需要搜索所有 $2^{k}$ 个可能的码字 $y$。经典码理论中，在构造具有特殊结构的码上已经作出了大量的努力，这些码能使纠错更有效地来执行。这些构造已超出了本章的范围，这个码的全局性质也可以用 Hamming 距离来理解。我们定义，一个码的距离为其任意两个码字之间的最小距离：
$$
d(C) \equiv \min _{x, y \in C, x \neq y} d(x, y)
$$
但是，$d(x, y)=\mathrm{wt}(x+y)$。由于码是线性的，若 $x$ 和 $y$ 为码字则 $x+y$ 也是码字，所以我们看到：
$$
d(C)=\min _{x \in C, x \neq 0} \mathrm{wt}(x)
$$
令 $d \equiv d(C)$，则 $C$ 为一个 $[n, k, d]$ 码。距离的重要性在于，对某个整数 $t$，简单地通过解码受污染的编码消息 $y^{\prime}$ 为满足 $d\left(y, y^{\prime}\right) \leqslant t$ 的惟一码字 $y$，具有距离至少为 $2 t+1$ 的一个码就能来纠正最多 $t$ 个比特上的差错。

Hamming 码是一类便于说明的线性纠错码。设 $r \geqslant 2$，为一个整数。令 $H$ 为一 个矩阵，其列为全部长度为 $r$ 的 $2^{r}-1$ 个不全为 0 的比特串。这个奇偶检验矩阵定义了一个称为 Hamming 码的 $\left[2^{r}-1,2^{r}-r-1\right]$ 线性码。对于量子纠错，一个特别重要的例子是 $r=3$ 的情况，它是一个 $[7,4]$ 码。具有如下奇偶检验矩阵：
$$
H=\left[\begin{array}{lllllll}
0 & 0 & 0 & 1 & 1 & 1 & 1 \\
0 & 1 & 1 & 0 & 0 & 1 & 1 \\
1 & 0 & 1 & 0 & 1 & 0 & 1
\end{array}\right]
$$
$H$ 的任意两列为不相同，因而为线性无关；前三列为线性相关，所以据定义，这个码的距离为 3。因此，这个码能来纠正任意单比特上的差错。事实上，这个纠错方法非常简单，设一个差错出现在第 $j$ 个比特上，对 $H$ 的检查显示，差错症状 $H e_{j}$ 正好就是 $j$ 的二进位表示，它告诉了哪个比特翻转以纠正差错。

现在通过对一些码的重要构造即对偶构造的解释，来结束对经典纠错码的概述。设 $C$ 为一个 $[n, k]$ 码，其具有生成矩阵 $G$ 和奇偶检验矩阵 $H$。那么，可定义另一个码，$C$ 的对偶码并记为 $C^{\perp}$，其具有生成矩阵 $G^{\mathrm{T}}$ 和奇偶检验矩阵 $H^{\top}$。等价地，$C$ 的对偶码由正交于 $C$ 中所有码字的全部码字 $y$ 组成。称一个码为弱自对偶 (weakly self-dual)，如果 $C \subseteq C^{\perp}$；称一个码为严格自对偶 (strictly self-dual),，如果 $C=C^{\perp}$。相当引人注目的是，对经典线性码的对偶构造会自然地出现于量子纠错的研究中，而且是构造 CSS 码的一类重要量子码的关键。

